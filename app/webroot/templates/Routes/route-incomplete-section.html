<section>
	<div class="col-xs-12">
		<div class="col-xs-3 text-center"></div>
		<div class="col-xs-2 text-center">
			<button class="btn btn-primary circle-button" ng-click="changeRouteStep(1)">1</button><br/>
			<span>ขั้นตอนที่ 1</span>
		</div>
		<div class="col-xs-2 text-center">
			<button class="btn btn-primary circle-button" ng-click="changeRouteStep(2)" ng-disabled="RouteStep == 1">2</button><br/>
			<span>ขั้นตอนที่ 2</span>
		</div>
		<div class="col-xs-2 text-center">
			<button class="btn btn-primary circle-button" ng-click="changeRouteStep(3)" ng-disabled="RouteStep == 1 || RouteStep == 2">3</button><br/>
			<span>ขั้นตอนที่ 3</span>
		</div>
		<div class="col-xs-3 text-center"></div>
	</div>
</section>
<section ng-if="RouteStep == 1">
	<h4 class="page-section-heading text-left no-padding"><strong>1. เพิ่มรายละเอียดเส้นทางเดินรถ</strong></h4>
	<hr/>
	<div class="form-horizontal" ng-form="RouteConfigForm">
    	<div class="form-group">
	    	<label for="RouteMainNumber" class="col-sm-2 control-label">สายหลัก <span class="error" ng-show="RouteConfigForm.RouteMainNumber.$error.required || RouteConfigForm.RouteMainNumber.$invalid">*</span></label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" name="RouteMainNumber" ng-model="RouteDetail.RouteMainNumber" placeholder="โปรดระบุหมายเลขสายหลัก" required />
	    	</div>
	    </div>
	    <div class="form-group">
	    	<label for="RouteNumber" class="col-sm-2 control-label">สายที่ <span class="error" ng-show="RouteConfigForm.RouteNumber.$error.required || RouteConfigForm.RouteNumber.$invalid">*</span></label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" name="RouteNumber" ng-model="RouteDetail.RouteNumber" placeholder="โปรดระบุหมายเลขสายที่" required />
	    	</div>
	    </div>
	    <div class="form-group">
	    	<label for="RouteName_TH" class="col-sm-2 control-label">ชื่อเส้นทาง ภาษาไทย <span class="error" ng-show="RouteConfigForm.RouteName_TH.$error.required || RouteConfigForm.RouteName_TH.$invalid">*</span></label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" name="RouteName_TH" ng-model="RouteDetail.RouteName_TH" placeholder="โปรดระบุชื่อเส้นทางภาษาไทย" required />
	    	</div>
	    </div>
	    <div class="form-group">
	    	<label for="RouteName_EN" class="col-sm-2 control-label">ชื่อเส้นทาง ภาษาอังกฤษ <span class="error" ng-show="RouteConfigForm.RouteName_EN.$error.required || RouteConfigForm.RouteName_EN.$invalid">*</span></label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" name="RouteName_EN" ng-model="RouteDetail.RouteName_EN" placeholder="โปรดระบุชื่อเส้นทางภาษาอังกฤษ" required />
	    	</div>
	    </div>
	    <div class="form-group">
	    	<label for="RouteType" class="col-sm-2 control-label">เที่ยวขา</label>
	    	<div class="col-sm-10">
	    		<select ng-model="RouteDetail.RouteType" class="form-control" name="RouteType">
	    			<option value="0">ขาขึ้น</option>
	    			<option value="1">ขาล่อง</option>
	    		</select>
	    	</div>
	    </div>	    
	    <div class="form-group">
	    	<label for="IsAvailabled" class="col-sm-2 control-label">เปิดบริการ</label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="checkbox" id="IsAvailabled" name="IsAvailabled" ng-model="RouteDetail.IsAvailabled"/>
	    	</div>
	    </div>
	    <div class="form-group">
	    	<label for="IsAvailabled" class="col-sm-2 control-label">เลือกประเภทรถ</label>
	    	<div class="col-sm-10">
	    		<div class="btn-group" data-toggle="buttons" ng-repeat="x in VehicleTypeList">
	    		<button style="margin-right: 5px" 
	    		ng-class="{'btn-success': x.IsSelectInRoute == true,'btn-default': x.IsSelectInRoute == false}"

	    		 type="btn" ng-click="slectVehicleType(x.VehicleTypeId,x.VehicleTypeName)">{{x.VehicleTypeName}}</button>
<!--     				<input type="btn btn-primary active"  style="margin-right: 5px" ng-click="slectVehicleType(x.VehicleTypeId,x.VehicleTypeName)" checked> {{x.VehicleTypeName}}
 -->  	
				</div>
			</div>
	    </div>
	    <div class="form-group">
	    	<label for="CommistionPerSales" class="col-sm-2 control-label">ค่าคอมมิชชันประจำทาง (%)</label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" id="CommistionPerSales" name="CommistionPerSales" ng-model="RouteDetail.CommistionPerSales" placeholder="ค่าคอมมิชชันประจำเส้นทางเดินรถ" required fcsa-number/>
	    	</div>
	    </div>
	    <hr/>
	    <div class="form-group">
	    	<label for="RouteDistance" class="col-sm-2 control-label">ระยะทาง (กม.)</label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" id="RouteDistance" name="RouteDistance" ng-model="RouteDetail.RouteDistance" placeholder="โปรดระบุระยะทางในการเดินทาง" required fcsa-number/>
	    	</div>
	    </div>

	    <div class="form-group" ng-repeat="item in RouteDuration">
	    	<label for="Duration{{$index}}" class="col-sm-2 control-label">เวลาเดินทาง {{VehicleTypeList[(VehicleTypeList | lswIndexOf: { VehicleTypeId: item.VehicleTypeId } : 'VehicleTypeId')].VehicleTypeName}} (ชม.)</label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="text" class="form-control" name="{{$index}}" ng-model="item.Duration" placeholder="โปรดระบุระยะเวลาในการเดินทาง" required fcsa-number/>
	    	</div>
	    </div>
	    <!-- <div class="form-group">
	    	<label for="RouteReverse" class="col-sm-2 control-label">ทำเส้นทางย้อนกลับ</label>
	    	<div class="col-sm-10">
	    		<input autocomplete="off" type="checkbox" name="RouteReverse" ng-model="RouteDetail.RouteReverse"/>
	    	</div>
	    </div> -->
    </div>
    <div class="col-xs-12 text-right">
    	<div class="col-xs-4 text-right"></div>
    	<div class="col-xs-4 text-center">
    		<button class="btn btn-warning" ng-disabled="VehicleSeatPlan.StandardAmount <= 0 || seatcapacityarrangementform.VehicleSeatPlanName.$error.required||(IsSlectVehicleType == true&&IsCompleted == true)" ng-click="saveRouteStep1(false)"><i class="glyphicon glyphicon-floppy-disk"></i> บันทึกขั้นตอนที่ 1</button>	
    	</div>
    	<div class="col-xs-4 text-left">
    		<button class="btn btn-primary" ng-disabled="VehicleSeatPlan.StandardAmount <= 0 || seatcapacityarrangementform.VehicleSeatPlanName.$error.required" ng-click="saveRouteStep1(true)">ขั้นตอนถัดไป <i class="glyphicon glyphicon-forward"></i></button>
    	</div>
    </div>
</section>

<section ng-if="RouteStep == 2">
	<div class="col-sm-12 no-padding">
    	<h4 class="page-section-heading text-left no-padding pull-left"><strong>2. เพิ่มจุดรับส่งผู้โดยสาร</strong></h4>	
    	<button class="btn btn-primary pull-right control-label" message-en="Are you sure to add province?" message-th="ต้องการที่จะเพิ่มจังหวัด ใช่หรือไม่?" lsw-confirm-modal="addProvince()" ng-disabled="RouteProviceList[0].ProvinceId == 0 || RouteProviceList[0].ProvinceId == ''">เพิ่มจังหวัด</button>
    </div>
    <div class="clearfix"></div>
    <hr/>
    <div class="col-xs-12">
    	<div class="col-xs-9">
    		<div class="col-xs-12" ng-repeat="eachProvice in RouteProviceList track by $index" ng-init="eachProvice.parentIndex = $index">
    			<label class="control-label">จังหวัด : {{ProvicesList.Provinces[(ProvicesList.Provinces | lswIndexOf: { ProvinceId: eachProvice.ProvinceId } : 'ProvinceId')].ProvinceName_TH}}</label><br/>
    			<div class="text-center" ng-repeat="stopPoint in eachProvice.StopPointList | orderBy:'RouteOrder'">
	    			<div class="pull-left text-center">
	    				<button class="btn circle-button" ng-class="{'btn-success':($index==0 && eachProvice.parentIndex == 0), 'btn-warning':(($index != 0) && stopPoint.IsTransit && (!($index == (eachProvice.StopPointList.length-1) && eachProvice.parentIndex == (RouteProviceList.length-1)))), 'btn-primary':($index != 0 || eachProvice.parentIndex > 0) && (!($index == (eachProvice.StopPointList.length-1) && eachProvice.parentIndex == (RouteProviceList.length-1))), 'btn-danger':($index == (eachProvice.StopPointList.length-1) && eachProvice.parentIndex == (RouteProviceList.length-1))}">
	    					<div ng-bind="numberOfRouteOrder(eachProvice.parentIndex,stopPoint.RouteOrder)"></div>
	    				</button><br/>
	    				{{stopPointData.StopPointList[(stopPointData.StopPointList | lswIndexOf: { StopPointId: stopPoint.StopPointId } : 'StopPointId')].StopPointName_TH}}
	    				<br/>
	    				{{(stopPointData.StopPointList[(stopPointData.StopPointList | lswIndexOf: { StopPointId: stopPoint.StopPointId } : 'StopPointId')].ProvinceName_TH)}}
	    			</div>
	    			<div class="pull-left" ng-if="$index != (eachProvice.StopPointList.length-1)">
	    				<a class="arrow-button"><i class="glyphicon glyphicon-arrow-right"></i></a>
	    			</div>
    			</div>
    			<div class="clearfix"></div>
    			<hr/>
    			<div class="text-center" style="font-size:40px;" ng-show="$index != (RouteProviceList.length-1)"><i class="fa fa-arrow-down"></i></div>
    		</div>
    	</div>
    	<div class="col-xs-3">
    		<div class="col-xs-12 no-padding">
	    		<label class="control-label">รายละเอียด</label>
	    		<div class="col-xs-12" style="border:1px #ccc solid; padding:10px;">
		    		<div class="col-xs-12 margin-bottom-5">
		    			<button class="btn btn-success circle-button">&nbsp;</button> จุดต้นทาง
		    		</div>
		    		<div class="col-xs-12 margin-bottom-5">
		    			<button class="btn btn-primary circle-button">&nbsp;</button> จุดระหว่างทาง
		    		</div>
		    		<div class="col-xs-12 margin-bottom-5">
		    			<button class="btn btn-warning circle-button">&nbsp;</button>  จุดที่สามารถเปลี่ยนเส้นทางได้
		    		</div>
		    		<div class="col-xs-12 margin-bottom-5">
		    			<button class="btn btn-danger circle-button">&nbsp;</button>  จุดปลายทาง
		    		</div>
	    		</div>
    		</div>
    		<div class="col-xs-12 no-padding" ng-if="RouteProviceList.length > 0">
    			<label class="control-label">มุมมองจังหวัด</label>
    			<div class="col-xs-12" style="border:1px #ccc solid; padding:10px;">
	    			<div class="col-xs-12 text-center" ng-repeat="eachProvice in RouteProviceList track by $index">
	    				<button class="btn" ng-class="{'btn-success':$index==0,'btn-primary':($index > 0 && $index < (RouteProviceList.length-1)),'btn-danger':($index == (RouteProviceList.length-1) && RouteProviceList.length != 1)}">
	    					{{ProvicesList.Provinces[(ProvicesList.Provinces | lswIndexOf: { ProvinceId: eachProvice.ProvinceId } : 'ProvinceId')].ProvinceName_TH}}
	    				</button>
	    				<div class="text-center" style="font-size:26px;" ng-show="$index != (RouteProviceList.length-1)">
	    					<i class="fa fa-arrow-down"></i>
	    				</div>
	    			</div>
	    		</div>
    		</div>
    	</div>
    </div>

    <div class="col-sm-12 no-padding">
    	<h5 class="page-section-heading text-left no-padding pull-left"><strong>จัดการจุดจอด</strong></h5>
    </div>
    <div class="clearfix"></div>
    <div class="col-xs-12 padding-top-10 padding-bottom-10">
    	<div class="col-xs-12 tabbable tabs-blocks tabs-primary no-padding">
			<ul class="nav nav-tabs" tabindex="7" style="overflow: hidden; outline: none;">
				<li ng-repeat="eachProvice in RouteProviceList track by $index" ng-class="{'active' : globalStatus.IsRouteProviceActive == $index}">
					<a ng-click="globalStatus.IsRouteProviceActive = $index"><i class="fa fa-gavel"></i> &nbsp;{{ProvicesList.Provinces[(ProvicesList.Provinces | lswIndexOf: { ProvinceId: eachProvice.ProvinceId } : 'ProvinceId')].ProvinceName_TH}}
					</a>
				</li>
			</ul>
			<div class="tab-content" style="padding:0px;">
				<div class="tab-pane" ng-class="{'active' : globalStatus.IsRouteProviceActive == $index}" ng-repeat="eachProvice in RouteProviceList track by $index">
					<div class="panel panel-primary text-center" style="border-radius:0px;border-top-right-radius:4px;">
						<div class="panel-heading text-right" style="border-top-left-radius:0px;padding:10px">
							<h3 class="pull-left" style="color:#FFF;font-size:30px;"> จัดการจุดจอดจังหวัด {{ProvicesList.Provinces[(ProvicesList.Provinces | lswIndexOf: { ProvinceId: eachProvice.ProvinceId } : 'ProvinceId')].ProvinceName_TH}}</h3>
							<button class="btn btn-default btn-xs" ng-disabled="$index == 0" ng-click="sortLeft(eachProvice, $index)">
								<i class="fa fa-arrow-left"></i>
							</button>
				    		<button class="btn btn-default btn-xs" ng-disabled="($index+1) == RouteProviceList.length" ng-click="sortRight(eachProvice, $index)">
				    			<i class="fa fa-arrow-right"></i>
				    		</button>
						</div>
						<div class="panel-body province-stoppoint">
				    		<div class="col-xs-7">
					    		<select ng-options="o.ProvinceId as o.ProvinceName_TH for o in ProvicesList.Provinces" ng-model="eachProvice.ProvinceId" class="form-control" name="Province" ng-disabled="eachProvice.StopPointList.length > 0">
		                            <option value="">--โปรดเลือกจังหวัด--</option>
		                        </select>
				    		</div>
				    		<div class="col-xs-5 text-right">
				    			<button class="btn btn-primary btn-xs" ng-disabled="eachProvice.ProvinceId == 0" ng-click="openSelectModalStopPoint(eachProvice.ProvinceId)"><i class="fa fa-plus"></i> เพิ่ม</button>
				    			<button class="btn btn-danger btn-xs" message-en="Are you sure to remove province?" message-th="ต้องการที่จะลบจังหวัด ใช่หรือไม่?" lsw-confirm-modal="removeProvince(eachProvice.hash)" ng-disabled="eachProvice.StopPointList.length > 0"><i class="fa fa-trash-o"></i> ลบ</button>
				    		</div>
				    		<div class="clearfix"><br/></div>
				    		<div class="col-xs-12" ng-repeat="stopPoint in eachProvice.StopPointList | orderBy:'RouteOrder'">
				    			<div class="nestable">
									<ul class="nestable-list">
										<li class="nestable-item" ng-class="{'animated pulse' : ((globalStatus.currentSortUpStopId == stopPoint.StopPointId) || (globalStatus.currentSortDownStopId == stopPoint.StopPointId))}">
										    <div class="nestable-handle nestable-handle-info text-left">
										    	<span ng-bind="numberOfRouteOrder(eachProvice.parentIndex,stopPoint.RouteOrder)"></span> : {{stopPointData.StopPointList[(stopPointData.StopPointList | lswIndexOf: { StopPointId: stopPoint.StopPointId } : 'StopPointId')].StopPointName_TH}} - {{stopPointData.StopPointList[(stopPointData.StopPointList | lswIndexOf: { StopPointId: stopPoint.StopPointId } : 'StopPointId')].ProvinceName_TH}} 
										    	<div class="text-right pull-right">
										    		<button class="btn btn-default btn-xs" ng-click="sortUp(stopPoint.StopPointId, stopPoint.RouteOrder, eachProvice.hash)" ng-disabled="!(stopPoint.RouteOrder > 1)">
										    			<i class="fa fa-arrow-up"></i>
										    		</button>
										    		<button class="btn btn-default btn-xs"ng-click="sortDown(stopPoint.StopPointId, stopPoint.RouteOrder, eachProvice.hash)" ng-disabled="!(stopPoint.RouteOrder < eachProvice.StopPointList.length)">
										    			<i class="fa fa-arrow-down"></i>
										    		</button>
										    		<button class="btn btn-danger btn-xs" message-en="Are you sure to delete this page?" message-th="ต้องการที่จะลบจุดจอดนี้ออกจากเส้นทาง ใช่หรือไม่?" lsw-confirm-modal="removeStopPoint(stopPoint.StopPointId, stopPoint.RouteOrder, eachProvice.hash)">
										    			<i class="fa fa-trash-o"></i> ลบ
										    		</button>
										    	</div>
										    	<div class="text-right pull-right" ng-show="numberOfRouteOrder(eachProvice.parentIndex,stopPoint.RouteOrder) > 1">
										    		<div class="col-md-8">
										    			ระยะเวลาเดินทาง (นาที) จากจุด  
										    			{{numberOfRouteOrder(eachProvice.parentIndex,eachProvice.StopPointList[$index-1].RouteOrder)}}
										    			<span><i class="fa fa-long-arrow-right" aria-hidden="true"></i></span>
										    			{{numberOfRouteOrder(eachProvice.parentIndex,stopPoint.RouteOrder)}}
										    			: 
										    		</div>
										    		<div class="col-md-4" style="margin-top:-6px">
										    			<input class="form-control" ng-model="stopPoint.Duration" lsw-only-digits fcsa-number/>
										    		</div>
										    	</div>
										    </div>
										</li>
									</ul>
								</div>
				    		</div>
			    		</div>
					</div>
				</div>
			</div>
		</div>
    </div>
    <div class="col-xs-12 text-center">
    	<div class="col-xs-4 text-right">
    		<button class="btn btn-primary" ng-click="changeRouteStep(1)"><i class="glyphicon glyphicon-backward"></i> ขั้นตอนก่อนหน้า</button>
    	</div>
    	<div class="col-xs-4 text-center">
    		<button class="btn btn-warning" ng-disabled="checkProvinceStopPoint()" ng-click="saveRouteStep2(false)"><i class="glyphicon glyphicon-floppy-disk"></i> บันทึกขั้นตอนที่ 2</button>	
    	</div>
    	<div class="col-xs-4 text-left">
    		<button class="btn btn-primary" ng-click="saveRouteStep2(true)" ng-disabled="checkProvinceStopPoint()">ขั้นตอนต่อไป <i class="glyphicon glyphicon-forward"></i></button>
    	</div>
    </div>
</section>
<section ng-if="RouteStep == 3">
	<div class="col-sm-12 no-padding">
    	<h4 class="page-section-heading text-left no-padding pull-left"><strong>3. กำหนดราคาบัตรโดยสาร</strong></h4>
    </div>
    <div class="clearfix"></div>
    <hr/>
    <div class="col-xs-12 tabbable tabs-blocks tabs-primary text-left">
		<ul class="nav nav-tabs" tabindex="3" style="overflow: hidden; outline: none;">
			<li ng-class="{'active' : globalStatus.IsPriceViewActive == 0}" class="cursor-point">
				<a ng-click="globalStatus.IsPriceViewActive = 0"><i class="fa fa-cube"></i> ราคาหน้าตู้
				</a>
			</li>
			<li ng-class="{'active' : globalStatus.IsPriceViewActive == 1}" class="cursor-point">
				<a ng-click="globalStatus.IsPriceViewActive = 1"><i class="fa fa-user-secret"></i> ราคาเอเจนซี่
				</a>
			</li>
			<li ng-class="{'active' : globalStatus.IsPriceViewActive == 2}" class="cursor-point">
				<a ng-click="globalStatus.IsPriceViewActive = 2"><i class="fa fa-tasks"></i> ราคาบัญชี
				</a>
			</li>
			<li ng-class="{'active' : globalStatus.IsPriceViewActive == 3}" class="cursor-point">
				<a ng-click="globalStatus.IsPriceViewActive = 3"><i class="fa fa-desktop"></i> ราคาหน้าเว็บไซต์
				</a>
			</li>
		</ul>
		<div class="tab-content" style="padding:0px;">
			<div class="tab-pane" ng-class="{'active' : globalStatus.IsPriceViewActive == 0}">
				<div class="panel panel-primary" style="border-radius:0px;border-top-right-radius:4px;">
					<div class="panel-heading" style="border-top-left-radius:0px;padding:10px">
						<h3 style="color:#FFF;font-size:30px;">ราคาหน้าตู้</h3>
					</div>
					<div class="panel-body province-stoppoint">
						<section ng-include="rootUrl + '../templates/Routes/Elements/route-box-price-section.html'"></section>
					</div>
				</div>
			</div>
			<div class="tab-pane" ng-class="{'active' : globalStatus.IsPriceViewActive == 1}">
				<div class="panel panel-primary" style="border-radius:0px;border-top-right-radius:4px;">
					<div class="panel-heading" style="border-top-left-radius:0px;padding:10px">
						<h3 style="color:#FFF;font-size:30px;">ราคาเอเจนซี่</h3>
					</div>
					<div class="panel-body province-stoppoint">
						<section ng-include="rootUrl + '../templates/Routes/Elements/route-agency-price-section.html'"></section>
					</div>
				</div>				
			</div>
			<div class="tab-pane" ng-class="{'active' : globalStatus.IsPriceViewActive == 2}">
				<div class="panel panel-primary" style="border-radius:0px;border-top-right-radius:4px;">
					<div class="panel-heading" style="border-top-left-radius:0px;padding:10px">
						<h3 style="color:#FFF;font-size:30px;">ราคาบัญชี</h3>
					</div>
					<div class="panel-body province-stoppoint">
						<section ng-include="rootUrl + '../templates/Routes/Elements/route-account-price-section.html'"></section>
					</div>
				</div>
			</div>
			<div class="tab-pane" ng-class="{'active' : globalStatus.IsPriceViewActive == 3}">
				<div class="panel panel-primary" style="border-radius:0px;border-top-right-radius:4px;">
					<div class="panel-heading" style="border-top-left-radius:0px;padding:10px">
						<h3 style="color:#FFF;font-size:30px;">ราคาหน้าเว็บไซต์</h3>
					</div>
					<div class="panel-body province-stoppoint">
						<section ng-include="rootUrl + '../templates/Routes/Elements/route-website-price-section.html'"></section>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xs-12 text-center">
    	<div class="col-xs-6 text-right">
    		<button class="btn btn-primary" ng-click="changeRouteStep(2)"><i class="glyphicon glyphicon-backward"></i> ขั้นตอนก่อนหน้า</button>
    	</div>
    	<div class="col-xs-6 text-left">
    		<button class="btn btn-primary" ng-click="saveRouteStep3()"><i class="glyphicon glyphicon-floppy-disk"></i> บันทึก</button>
    	</div>
    </div>
</section>